u2 <- (-b + sqrt(discriminant)) / (2*a)
}
return(u2)
}
# Simulation function
simulate_fgm <- function(n, alpha) {
# Step 1: Sample U1 from Uniform(0,1)
u1 <- runif(n)
# Step 2: Sample U2 | U1 for each u1
u2 <- sapply(u1, function(x) sample_u2_given_u1(x, alpha))
return(data.frame(U1 = u1, U2 = u2))
}
### Quantile Estimation
n<-5000
d<-5
set.seed(seeds[1])
# independent uniform
#X<-matrix(runif(n=d*n), nrow=n, ncol=d)
# uniform with Gaussian copula
# X <- gaussian_copula_uniform_sim(n = n, d = 2)$uniform_data
X<-simulate_fgm(n=n, alpha=1)
X<-cbind(X,matrix(runif( (d-2)*n ), nrow=n, ncol=d-2 ))
vectors <- matrix(c(
rep(0, d),
0, 1, rep(0,d-2),
1, rep(0,d-1)
), nrow = 3, byrow = TRUE)
# Generate random draws
# sample() will generate indices, which we use to select rows from the matrix
M <- vectors[apply(X,1, function(x) sample(1:3, size = 1, prob=c((x[1]+x[2])/3, (2-x[1])/3, (1-x[2])/3), replace = TRUE)), ]
X.NA<-X
X.NA[M==1]<-NA
colnames(X)<-NULL
colnames(X)<-paste0("X",1:d)
colnames(X.NA)<-paste0("X",1:d)
n<-nrow(X)
################################## imputations #########################################
########################################################################################
## Add your favorite imputations here
imputations<-list()
#knn
impute_knn <- function(X) { return(impute.knn(as.matrix(X), colmax=0.99)$data) }
#missForest
impute_missForest <- function(X) { return(missForest(X)$ximp) }
# mice_cart
impute_mice_cart <-  miceDRF::create_mice_imputation("cart")
# mice_rf
impute_mice_rf <- miceDRF::create_mice_imputation("rf")
# mice_drf
impute_mice_drf <- miceDRF::create_mice_imputation("DRF")
imputation_list<-list(knn=impute_knn,
missForest=impute_missForest,
mice_cart=impute_mice_cart,
mice_rf=impute_mice_rf,
mice_drf=impute_mice_drf)
scores<-Iscores_compare(X.NA, imputation_list, N = 10)
scores
n<-5000
# Load required packages
library(mice)
library(MASS)  # For multivariate normal distribution
library(miceDRF)
library(ggplot2)
# Set seed for reproducibility
set.seed(123)
library(drf)
### Define Imputation Functions
#knn
impute_knn <- function(X) { return(impute.knn(as.matrix(X), colmax=0.99)$data) }
#missForest
impute_missForest <- function(X) { return(missForest(X)$ximp) }
# mice_cart
impute_mice_cart <-  miceDRF::create_mice_imputation("cart")
# mice_rf
impute_mice_rf <- miceDRF::create_mice_imputation("rf")
# mice_drf
impute_mice_drf <- miceDRF::create_mice_imputation("DRF")
impute_knn(X.NA[sample(1:nrow(data), size=n, replace=T),])
impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])
quantile(impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1])
quantile(impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
# Load required packages
library(mice)
library(MASS)  # For multivariate normal distribution
library(miceDRF)
library(ggplot2)
# Set seed for reproducibility
set.seed(123)
library(drf)
### Define Imputation Functions
#knn
impute_knn <- function(X) { return(impute.knn(as.matrix(X), colmax=0.99)$data) }
#missForest
impute_missForest <- function(X) { return(missForest(X)$ximp) }
# mice_cart
impute_mice_cart <-  miceDRF::create_mice_imputation("cart")
# mice_rf
impute_mice_rf <- miceDRF::create_mice_imputation("rf")
# mice_drf
impute_mice_drf <- miceDRF::create_mice_imputation("DRF")
methods<-c("knn", "missForest", "mice_cart", "mice_rf", "mice_drf")
n<-5000
d<-5
alpha<-0.1
B<-50
L<-20
resultsboot<-list()
for (method in methods){
resultsboot[[method]] <- data.frame(
beta_imp = numeric(B),
se_imp = numeric(B),
ci_lower = numeric(B),
ci_upper = numeric(B),
included = logical(B)
)
}
resultsboot
b<1-
b<-1
X<-simulate_fgm(n=n, alpha=1)
X<-cbind(X,matrix(runif( (d-2)*n ), nrow=n, ncol=d-2 ))
vectors <- matrix(c(
rep(0, d),
0, 1, rep(0,d-2),
1, rep(0,d-1)
), nrow = 3, byrow = TRUE)
# Generate random draws
# sample() will generate indices, which we use to select rows from the matrix
M <- vectors[apply(X,1, function(x) sample(1:3, size = 1, prob=c((x[1]+x[2])/3, (2-x[1])/3, (1-x[2])/3), replace = TRUE)), ]
X.NA<-X
X.NA[M==1]<-NA
colnames(X)<-NULL
colnames(X)<-paste0("X",1:d)
colnames(X.NA)<-paste0("X",1:d)
n<-nrow(X)
#Bootstrapping L times
res<-matrix(NA, nrow=L, ncol=1)
for (l in 1:L){
## Each time impute + calculate quantile!
res[["knn"]][l]<-quantile(impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["missForest"]][l]<-quantile(impute_missForest(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["mice_cart"]][l]<-quantile(impute_mice_cart(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["mice_rf"]][l]<-quantile(impute_mice_rf(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["mice_drf"]][l]<-quantile(impute_mice_drf(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
}
#Bootstrapping L times
res<-list()
for (l in 1:L){
## Each time impute + calculate quantile!
res[["knn"]][l]<-quantile(impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["missForest"]][l]<-quantile(impute_missForest(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["mice_cart"]][l]<-quantile(impute_mice_cart(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["mice_rf"]][l]<-quantile(impute_mice_rf(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
res[["mice_drf"]][l]<-quantile(impute_mice_drf(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
}
res
X.NA[sample(1:nrow(X.NA), size=n, replace=T),]
quantile(impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
quantile(impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
quantile(impute_knn(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
quantile(impute_mice_rf(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
quantile(impute_mice_rf(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
quantile(impute_mice_rf(X.NA[sample(1:nrow(X.NA), size=n, replace=T),])[,1], probs=0.1)
## Each time impute + calculate quantile!
Xl<-X.NA[sample(1:nrow(X.NA), size=n, replace=T),]
Xl
quantile(impute_knn(Xl)[,1], probs=0.1)
Xl<-X.NA[sample(1:nrow(X.NA), size=n, replace=T),]
quantile(impute_knn(Xl)[,1], probs=0.1)
L<-3
res<-list()
for (l in 1:L){
## Each time impute + calculate quantile!
Xl<-X.NA[sample(1:nrow(X.NA), size=n, replace=T),]
res[["knn"]][l]<-quantile(impute_knn(Xl)[,1], probs=0.1)
res[["missForest"]][l]<-quantile(impute_missForest(Xl)[,1], probs=0.1)
res[["mice_cart"]][l]<-quantile(impute_mice_cart(Xl)[,1], probs=0.1)
res[["mice_rf"]][l]<-quantile(impute_mice_rf(Xl)[,1], probs=0.1)
res[["mice_drf"]][l]<-quantile(impute_mice_drf(Xl)[,1], probs=0.1)
}
res
for (method in methods){
resultsboot[[method]]$beta_imp[b]<- mean(res[[method]])
resultsboot[[method]]$se_imp[b]<-sqrt(mean( (c(res)-resultsboot$beta_imp[b])^2 ))
# Calculate confidence intervals (95%)
resultsboot[[method]]$ci_lower[b] <- resultsboot$beta_imp[b] - 1.96 * resultsboot$se_imp[b]
resultsboot[[method]]$ci_upper[b] <- resultsboot$beta_imp[b] + 1.96 * resultsboot$se_imp[b]
# Check if true value (0) is in the confidence interval
resultsboot[[method]]$included[b] <- resultsboot$ci_lower[b] <= 0 && 0 <= resultsboot$ci_upper[b]
}
method<-methods[1]
method
res[[method]]
mean(res[[method]])
resultsboot[[method]]$beta_imp[b]<- mean(res[[method]])
sqrt(mean( (c(res)-resultsboot$beta_imp[b])^2 ))
res[[method]]
resultsboot[[method]]$se_imp[b]<-sqrt(mean( (c(res[[method]])-resultsboot[[method]]$beta_imp[b])^2 ))
resultsboot
resultsboot[[method]]
# Calculate confidence intervals (95%)
resultsboot[[method]]$ci_lower[b] <- resultsboot[[method]]$beta_imp[b] - 1.96 * resultsboot[[method]]$se_imp[b]
resultsboot[[method]]$ci_upper[b] <- resultsboot[[method]]$beta_imp[b] + 1.96 * resultsboot[[method]]$se_imp[b]
resultsboot[[method]]
for (method in methods){
resultsboot[[method]]$beta_imp[b]<- mean(res[[method]])
resultsboot[[method]]$se_imp[b]<-sqrt(mean( (c(res[[method]])-resultsboot[[method]]$beta_imp[b])^2 ))
# Calculate confidence intervals (95%)
resultsboot[[method]]$ci_lower[b] <- resultsboot[[method]]$beta_imp[b] - 1.96 * resultsboot[[method]]$se_imp[b]
resultsboot[[method]]$ci_upper[b] <- resultsboot[[method]]$beta_imp[b] + 1.96 * resultsboot[[method]]$se_imp[b]
# Check if true value (0) is in the confidence interval
resultsboot[[method]]$included[b] <- resultsboot[[method]]$ci_lower[b] <= 0 && 0 <= resultsboot[[method]]$ci_upper[b]
}
resultsboot
# Load required packages
library(mice)
library(MASS)  # For multivariate normal distribution
library(miceDRF)
library(ggplot2)
# Set seed for reproducibility
set.seed(123)
library(drf)
### Define Imputation Functions
#knn
impute_knn <- function(X) { return(impute.knn(as.matrix(X), colmax=0.99)$data) }
#missForest
impute_missForest <- function(X) { return(missForest(X)$ximp) }
# mice_cart
impute_mice_cart <-  miceDRF::create_mice_imputation("cart")
# mice_rf
impute_mice_rf <- miceDRF::create_mice_imputation("rf")
# mice_drf
impute_mice_drf <- miceDRF::create_mice_imputation("DRF")
methods<-c("knn", "missForest", "mice_cart", "mice_rf", "mice_drf")
n<-5000
d<-5
alpha<-0.1
B<-50
L<-20
resultsboot<-list()
for (method in methods){
resultsboot[[method]] <- data.frame(
beta_imp = numeric(B),
se_imp = numeric(B),
ci_lower = numeric(B),
ci_upper = numeric(B),
included = logical(B)
)
}
# Run simulations
for (b in 1:B) {
cat(b)
X<-simulate_fgm(n=n, alpha=1)
X<-cbind(X,matrix(runif( (d-2)*n ), nrow=n, ncol=d-2 ))
vectors <- matrix(c(
rep(0, d),
0, 1, rep(0,d-2),
1, rep(0,d-1)
), nrow = 3, byrow = TRUE)
# Generate random draws
# sample() will generate indices, which we use to select rows from the matrix
M <- vectors[apply(X,1, function(x) sample(1:3, size = 1, prob=c((x[1]+x[2])/3, (2-x[1])/3, (1-x[2])/3), replace = TRUE)), ]
X.NA<-X
X.NA[M==1]<-NA
colnames(X)<-NULL
colnames(X)<-paste0("X",1:d)
colnames(X.NA)<-paste0("X",1:d)
n<-nrow(X)
################################## imputations #########################################
########################################################################################
#Bootstrapping L times
res<-list()
for (l in 1:L){
## Each time impute + calculate quantile!
Xl<-X.NA[sample(1:nrow(X.NA), size=n, replace=T),]
res[["knn"]][l]<-quantile(impute_knn(Xl)[,1], probs=0.1)
res[["missForest"]][l]<-quantile(impute_missForest(Xl)[,1], probs=0.1)
res[["mice_cart"]][l]<-quantile(impute_mice_cart(Xl)[,1], probs=0.1)
res[["mice_rf"]][l]<-quantile(impute_mice_rf(Xl)[,1], probs=0.1)
res[["mice_drf"]][l]<-quantile(impute_mice_drf(Xl)[,1], probs=0.1)
}
for (method in methods){
resultsboot[[method]]$beta_imp[b]<- mean(res[[method]])
resultsboot[[method]]$se_imp[b]<-sqrt(mean( (c(res[[method]])-resultsboot[[method]]$beta_imp[b])^2 ))
# Calculate confidence intervals (95%)
resultsboot[[method]]$ci_lower[b] <- resultsboot[[method]]$beta_imp[b] - 1.96 * resultsboot[[method]]$se_imp[b]
resultsboot[[method]]$ci_upper[b] <- resultsboot[[method]]$beta_imp[b] + 1.96 * resultsboot[[method]]$se_imp[b]
# Check if true value (0) is in the confidence interval
resultsboot[[method]]$included[b] <- resultsboot[[method]]$ci_lower[b] <= 0 && 0 <= resultsboot[[method]]$ci_upper[b]
}
# Optional: print progress
if (b %% 100 == 0) cat("Completed", b, "simulations\n")
}
b
for (method in methods){
# Summarize results
coverage_probability_Bootstrap <- mean(resultsboot[[method]]$included)
cat("Coverage probability:", coverage_probability_Bootstrap, "\n")
resultsboot[[method]] <- resultsboot[[method]][order(resultsboot[[method]]$beta_imp), ]
resultsboot$sim_id <- 1:nrow(resultsboot[[method]])
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = 0, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value")) +
labs(title = "Confidence Interval Coverage Bootstrap",
subtitle = sprintf("Coverage rate: %.1f%% (expected: 95%%)",
mean(resultsboot$included) * 100),
x = "Simulation run (ordered by estimate)",
y = expression(hat(beta)),
color = "") +
theme_minimal() +
theme(legend.position = "bottom")
}
method<-"knn"
# Summarize results
coverage_probability_Bootstrap <- mean(resultsboot[[method]]$included)
cat("Coverage probability:", coverage_probability_Bootstrap, "\n")
resultsboot[[method]]
resultsboot[[method]]$ci_lower[b] <= 0 && 0 <= resultsboot[[method]]$ci_upper[b]
resultsboot[[method]]$ci_lower[b] <= alpha && alpha <= resultsboot[[method]]$ci_upper[b]
resultsboot[[method]] <- resultsboot[[method]][order(resultsboot[[method]]$beta_imp), ]
resultsboot$sim_id <- 1:nrow(resultsboot[[method]])
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = 0, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value")) +
labs(title = "Confidence Interval Coverage Bootstrap",
subtitle = sprintf("Coverage rate: %.1f%% (expected: 95%%)",
mean(resultsboot$included) * 100),
x = "Simulation run (ordered by estimate)",
y = expression(hat(beta)),
color = "") +
theme_minimal() +
theme(legend.position = "bottom")
resultsboot$sim_id
resultsboot[[method]]
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = 0, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value")) +
labs(title = "Confidence Interval Coverage Bootstrap",
subtitle = sprintf("Coverage rate: %.1f%% (expected: 95%%)",
mean(resultsboot$included) * 100),
x = "Simulation run (ordered by estimate)",
y = expression(hat(beta)),
color = "") +
theme_minimal() +
theme(legend.position = "bottom")
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = 0, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value"))
resultsboot[[method]] <- resultsboot[[method]][order(resultsboot[[method]]$beta_imp), ]
resultsboot[[method]]$sim_id <- 1:nrow(resultsboot[[method]])
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = 0, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value"))
method<-"mice_cart"
# Summarize results
coverage_probability_Bootstrap <- mean(resultsboot[[method]]$included)
cat("Coverage probability:", coverage_probability_Bootstrap, "\n")
resultsboot[[method]] <- resultsboot[[method]][order(resultsboot[[method]]$beta_imp), ]
resultsboot[[method]]$sim_id <- 1:nrow(resultsboot[[method]])
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = 0, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value")) +
labs(title = "Confidence Interval Coverage Bootstrap",
subtitle = sprintf("Coverage rate: %.1f%% (expected: 95%%)",
mean(resultsboot$included) * 100),
x = "Simulation run (ordered by estimate)",
y = expression(hat(beta)),
color = "") +
theme_minimal() +
theme(legend.position = "bottom")
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = 0, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value"))
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = alpha, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value"))
method<-"knn"
coverage_probability_Bootstrap <- mean(resultsboot[[method]]$included)
cat("Coverage probability:", coverage_probability_Bootstrap, "\n")
resultsboot[[method]] <- resultsboot[[method]][order(resultsboot[[method]]$beta_imp), ]
resultsboot[[method]]$sim_id <- 1:nrow(resultsboot[[method]])
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = alpha, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value"))
method<-"mice_cart"
coverage_probability_Bootstrap <- mean(resultsboot[[method]]$included)
cat("Coverage probability:", coverage_probability_Bootstrap, "\n")
resultsboot[[method]] <- resultsboot[[method]][order(resultsboot[[method]]$beta_imp), ]
resultsboot[[method]]$sim_id <- 1:nrow(resultsboot[[method]])
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = alpha, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value"))
method<-"mice_rf"
coverage_probability_Bootstrap <- mean(resultsboot[[method]]$included)
cat("Coverage probability:", coverage_probability_Bootstrap, "\n")
resultsboot[[method]] <- resultsboot[[method]][order(resultsboot[[method]]$beta_imp), ]
resultsboot[[method]]$sim_id <- 1:nrow(resultsboot[[method]])
# Create the plot
ggplot(resultsboot[[method]], aes(x = sim_id, y = beta_imp)) +
# Color CIs by whether they cover the true value
geom_linerange(aes(ymin = ci_lower, ymax = ci_upper,
color = included),
alpha = 0.6, linewidth = 0.5) +
geom_point(aes(color = included), size = 0.8) +
# True parameter value
geom_hline(yintercept = alpha, linetype = "dashed",
color = "black", linewidth = 0.8) +
scale_color_manual(values = c("TRUE" = "gray60", "FALSE" = "red"),
labels = c("TRUE" = "Covers true value",
"FALSE" = "Misses true value"))
impute_missForest(Xl)[,1]
quantile(impute_missForest(Xl)[,1], probs=0.1)
resultsboot[[method]]
